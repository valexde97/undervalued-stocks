import{e as g,j as r,u as S,i as b,r as i}from"./index-xvdbN6-H.js";import{S as F,l as h}from"./home.module-CbfyJERK.js";import{m as w}from"./proxy-BozZERwT.js";const N=g,y={};function C({stocks:s}){const t=Array.isArray(s)?s:[];return t.length===0?r.jsx("div",{className:y.empty,children:"No stocks to show"}):r.jsx("div",{className:y.grid,children:t.map(n=>r.jsx(F,{stock:n},n.ticker))})}function E(s,t){const n=typeof(t==null?void 0:t.c)=="number"?t.c:void 0,a=typeof(t==null?void 0:t.dp)=="number"?t.dp:void 0;return{ticker:s,name:s,price:n,changePct:a,category:void 0,sector:void 0,industry:void 0,country:void 0,marketCap:void 0,pe:void 0,ps:void 0,pb:void 0}}const I=()=>{const{t:s}=S(),{favorites:t,clearFavorites:n}=b(),a=N(o=>o.stocks.items),[l,x]=i.useState({}),[k,p]=i.useState(!1),c=i.useMemo(()=>{const o=new Set(a.map(e=>e.ticker));return t.filter(e=>!o.has(e))},[t,a]);i.useEffect(()=>{let o=!1;async function e(){if(c.length!==0)try{p(!0);const d=encodeURIComponent(c.join(",")),m=await(await fetch(`/api/fh/quotes-batch?symbols=${d}`)).json();if(o)return;const v={},j=(m==null?void 0:m.quotes)??{};for(const f of c)v[f]=E(f,j[f]);x(v)}catch(d){console.warn("Failed to load favorite quotes:",d)}finally{o||p(!1)}}return e(),()=>{o=!0}},[c]);const u=i.useMemo(()=>{const o={};for(const e of a)o[e.ticker]=e;for(const e of Object.keys(l))o[e]=l[e];return t.map(e=>o[e]).filter(Boolean)},[t,a,l]);return r.jsx(w.div,{className:h.page,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:r.jsxs("div",{className:h.container,children:[r.jsx("h2",{children:s("yourFavorites")}),u.length>0&&r.jsxs("button",{onClick:n,style:{marginBottom:"1rem"},children:["ðŸ§¹ ",s("clearFavorites")]}),u.length>0?r.jsx(C,{stocks:u}):r.jsx("p",{children:k?"Loadingâ€¦":s("noFavorites")})]})})};export{I as default};
